!function(){var e=angular.module("whosthat",[]);e.controller("MovieController",["$scope","$http",function(e,t){var o=this;o.cast=[],o.credits=[],o.title="",o.search=!0,o.seasons=[],o.episodes=[],o.showID=0,this.findMovie=function(e){"seven"===e.toLowerCase()&&(e="se7en"),t.get("http://api.themoviedb.org/3/search/movie",{params:{api_key:"9314b8803e6b1e173d0c8a52303b82ce",query:e}}).success(function(e){o.movieID=e.results[0].id,o.title=e.results[0].title,o.getCast(o.movieID),o.search=!1}).error(function(){console.log("whoops")})},this.findShow=function(e){t.get("http://api.themoviedb.org/3/search/tv",{params:{api_key:"9314b8803e6b1e173d0c8a52303b82ce",query:e}}).success(function(e){console.log(e),o.showID=e.results[0].id,o.title=e.results[0].name,console.log(o.title),console.log(o.showID),o.getSeasonInfo(o.showID)}).error(function(){console.log("whoops")})},this.getSeasonInfo=function(e){t.get("http://api.themoviedb.org/3/tv/"+e,{params:{api_key:"9314b8803e6b1e173d0c8a52303b82ce"}}).success(function(e){o.seasons=o.count(e.number_of_seasons)}).error(function(){console.log("whoops")})},this.count=function(e){var t=[];for(i=1;e>=i;i++)t.push(i);return t},this.getEpisodes=function(e,s){t.get("http://api.themoviedb.org/3/tv/"+e+"/season/"+s,{params:{api_key:"9314b8803e6b1e173d0c8a52303b82ce"}}).success(function(e){o.episodes=o.count(e.episodes.length)}).error(function(){console.log("whoops")})},this.getEpisodeCredits=function(e,s,i){t.get("http://api.themoviedb.org/3/tv/"+e+"/season/"+s+"/episode/"+i+"/credits",{params:{api_key:"9314b8803e6b1e173d0c8a52303b82ce"}}).success(function(e){o.cast=[],o.parseCast(o.episodeCastParse(e))}).error(function(){console.log("whoops")})},this.episodeCastParse=function(e){console.log(e.guest_stars);var t=e.cast;return e.guest_stars.forEach(function(e){t.push(e)}),t},this.getCast=function(e){o.cast=[],t.get("http://api.themoviedb.org/3/movie/"+e+"/credits",{params:{api_key:"9314b8803e6b1e173d0c8a52303b82ce"}}).success(function(e){o.parseCast(e.cast)}).error(function(){console.log("whoops")})},this.parseCast=function(e){console.log(e),e.forEach(function(e){e.profile_path&&o.cast.push({actor:e.name,id:e.id,character:e.character,imgsrc:"http://image.tmdb.org/t/p/w185/"+e.profile_path})}),console.log(o.cast)},this.getCredits=function(e){o.credits=[],t.get("http://api.themoviedb.org/3/person/"+e+"/credits",{params:{api_key:"9314b8803e6b1e173d0c8a52303b82ce"}}).success(function(e){o.parseCredits(e.cast)}).error(function(){console.log("whoops")})},this.parseCredits=function(e){e.forEach(function(e){var t="";t=e.poster_path?"http://image.tmdb.org/t/p/w185/"+e.poster_path:"img/not-found.png",e.title&&e.id&&e.release_date&&e.poster_path&&o.credits.push({title:e.title,id:e.id,character:e.character||"",postersrc:t,year:e.release_date})}),console.log(o.credits)}}]),e.directive("typeTabs",function(){return{restrict:"E",templateUrl:"type-tabs.html",controller:function(){this.tab=1,this.isSet=function(e){return this.tab===e},this.setTab=function(e){this.tab=e}},controllerAs:"tab"}})}();